-- 跳过防多开和白名单验证部分，直接添加WindUI加载代码

-- ==================== 从 GitHub 加载 WindUI 库 ====================
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/qiaoxxyxx/Roblox/refs/heads/main/ui"))()

-- 获取本地玩家引用
local e = game:GetService("Players").LocalPlayer

-- 设置防挂机
e.Idled:Connect(function()
    game:GetService("VirtualUser"):Button2Down(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
    wait(1)
    game:GetService("VirtualUser"):Button2Up(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
end)

-- ==================== 添加功能到Strength分类 ====================
-- 全局变量
local spamTraining = false
local batchSize = 20  -- 固定批次大小

-- 极速发送锻炼事件
local function spamExerciseEvents()
    while spamTraining do
        pcall(function()
            -- 批量发送事件
            local muscleEvent = e.muscleEvent
            for i = 0, batchSize do
                muscleEvent:FireServer("rep")
            end
        end)
        
        task.wait(0.01)  -- 极小延迟保持稳定
    end
end

-- 1. 极速锻炼功能（覆盖原来的自动训练）
WindUI.AddFunction("Strength", "极速锻炼", function(state)
    spamTraining = state
    if state then
        task.spawn(spamExerciseEvents)
        print("极速锻炼已开启")
    else
        print("极速锻炼已关闭")
    end
end)

-- 2. 自动使用蛋白蛋
WindUI.AddFunction("Strength", "自动蛋白蛋", function(state)
    _G.Z = state
    print("自动蛋白蛋: " .. (state and "ON" or "OFF"))
    if state then
        spawn(function()
            while _G.Z do
                wait(0.2)
                pcall(function()
                    if not e.boostTimersFolder:FindFirstChild("Protein Egg") then
                        local egg = e.Backpack:FindFirstChild("Protein Egg")
                        if egg then
                            e.Character.Humanoid:EquipTool(egg)
                            wait(0.1)
                            if e.Character:FindFirstChild("Protein Egg") then
                                e.muscleEvent:FireServer("proteinEgg", e.Character:FindFirstChild("Protein Egg"))
                                wait(0.1)
                                e.Character.Humanoid:UnequipTools()
                            end
                        end
                    end
                end)
            end
        end)
    end
end)

-- 3. 清除增益UI
WindUI.AddFunction("Strength", "清除增益UI", function(state)
    local function ClearGainUI()
        local coreGui = game:GetService("CoreGui")
        local playerGui = e:FindFirstChild("PlayerGui")
        local keywords = {"+","Coins","Coin","Strength","Exp","Experience","Level","Damage","Health"}
        local protectedNames = {"WindUI","Crazy Top","Rayfield"}
        
        -- 清理CoreGui
        for _, gui in ipairs(coreGui:GetChildren()) do
            if gui:IsA("ScreenGui") then
                local isProtected = false
                for _, name in ipairs(protectedNames) do
                    if gui.Name:find(name) then
                        isProtected = true
                        break
                    end
                end
                if not isProtected then
                    local shouldRemove = false
                    for _, element in ipairs(gui:GetDescendants()) do
                        if (element:IsA("TextLabel") or element:IsA("TextButton")) and element.Text then
                            local text = element.Text
                            for _, keyword in ipairs(keywords) do
                                if text:find(keyword) or text:find("%+%d+") then
                                    shouldRemove = true
                                    break
                                end
                            end
                            if shouldRemove then break end
                        end
                    end
                    if shouldRemove then gui:Destroy() end
                end
            end
        end
        
        -- 清理PlayerGui
        if playerGui then
            for _, gui in ipairs(playerGui:GetChildren()) do
                if gui:IsA("ScreenGui") then
                    local isProtected = false
                    for _, name in ipairs(protectedNames) do
                        if gui.Name:find(name) then
                            isProtected = true
                            break
                        end
                    end
                    if not isProtected then
                        local shouldRemove = false
                        for _, element in ipairs(gui:GetDescendants()) do
                            if (element:IsA("TextLabel") or element:IsA("TextButton")) and element.Text then
                                local text = element.Text
                                for _, keyword in ipairs(keywords) do
                                    if text:find(keyword) or text:find("%+%d+") then
                                        shouldRemove = true
                                        break
                                    end
                                end
                                if shouldRemove then break end
                            end
                        end
                        if shouldRemove then gui:Destroy() end
                    end
                end
            end
        end
        print("增益UI已清除!")
    end
    ClearGainUI()
end)

-- 4. 可选：自动使用热带奶昔（菠萝）
WindUI.AddFunction("Strength", "自动热带奶昔", function(state)
    _G.W = state
    print("自动热带奶昔: " .. (state and "ON" or "OFF"))
    if state then
        spawn(function()
            while _G.W do
                wait(0.1)
                pcall(function()
                    local shake = e.Backpack:FindFirstChild("Tropical Shake")
                    if shake then
                        e.Character.Humanoid:EquipTool(shake)
                        wait(0.05)
                        if e.Character:FindFirstChild("Tropical Shake") then
                            e.muscleEvent:FireServer("tropicalShake", e.Character:FindFirstChild("Tropical Shake"))
                            wait(0.05)
                            e.Character.Humanoid:UnequipTools()
                        end
                    end
                end)
            end
        end)
    end
end)

-- ==================== 脚本加载完成 ====================
print("脚本加载完成！")
print("Strength窗口包含：极速锻炼、自动蛋白蛋、清除增益UI、自动热带奶昔")
