-- ==================== WindUIé£æ ¼æ•°æ®ç›‘æ§ ====================
local function createWindUIDataMonitor()
    local player = game:GetService("Players").LocalPlayer
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "WindUI_DataMonitor"
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    screenGui.Parent = game:GetService("Players").LocalPlayer:WaitForChild("PlayerGui")

    -- ä¸»çª—å£
    local mainWindow = Instance.new("Frame")
    mainWindow.Name = "DataMonitorWindow"
    mainWindow.Size = UDim2.new(0, 350, 0, 200)
    mainWindow.Position = UDim2.new(0.5, -175, 0.7, 0)
    mainWindow.BackgroundColor3 = Color3.fromRGB(20, 12, 28)
    mainWindow.BackgroundTransparency = 0.1
    mainWindow.ZIndex = 10
    mainWindow.Parent = screenGui
    
    local border = Instance.new("Frame")
    border.Size = UDim2.new(1, 3, 1, 3)
    border.Position = UDim2.new(0, -1.5, 0, -1.5)
    border.BackgroundColor3 = Color3.fromRGB(100, 60, 150)
    border.ZIndex = 9
    border.Parent = mainWindow
    
    local innerBorder = Instance.new("Frame")
    innerBorder.Size = UDim2.new(1, -3, 1, -3)
    innerBorder.Position = UDim2.new(0, 1.5, 0, 1.5)
    innerBorder.BackgroundColor3 = Color3.fromRGB(18, 10, 25)
    innerBorder.BackgroundTransparency = 0.2
    innerBorder.ZIndex = 10
    innerBorder.Parent = border
    
    -- æ ‡é¢˜æ 
    local titleBar = Instance.new("TextButton")
    titleBar.Name = "TitleBar"
    titleBar.Size = UDim2.new(1, 0, 0, 25)
    titleBar.BackgroundColor3 = Color3.fromRGB(30, 18, 40)
    titleBar.Text = ""
    titleBar.AutoButtonColor = false
    titleBar.ZIndex = 11
    titleBar.Parent = innerBorder
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, -40, 1, 0)
    titleLabel.Position = UDim2.new(0, 8, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = "ğŸ“Š æ•°æ®ç›‘æ§"
    titleLabel.TextColor3 = Color3.fromRGB(255, 180, 230)
    titleLabel.TextSize = 12
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.ZIndex = 11
    titleLabel.Parent = titleBar
    
    local minimizeButton = Instance.new("TextButton")
    minimizeButton.Size = UDim2.new(0, 20, 0, 20)
    minimizeButton.Position = UDim2.new(1, -22, 0.5, -10)
    minimizeButton.AnchorPoint = Vector2.new(0.5, 0.5)
    minimizeButton.BackgroundColor3 = Color3.fromRGB(45, 25, 65)
    minimizeButton.Text = "â”€"
    minimizeButton.TextColor3 = Color3.fromRGB(200, 150, 235)
    minimizeButton.TextSize = 16
    minimizeButton.Font = Enum.Font.GothamBold
    minimizeButton.AutoButtonColor = false
    minimizeButton.ZIndex = 11
    minimizeButton.Parent = titleBar
    
    -- å†…å®¹åŒºåŸŸ
    local contentFrame = Instance.new("Frame")
    contentFrame.Name = "Content"
    contentFrame.Size = UDim2.new(1, -6, 1, -31)
    contentFrame.Position = UDim2.new(0, 3, 0, 28)
    contentFrame.BackgroundTransparency = 1
    contentFrame.ZIndex = 11
    contentFrame.Parent = innerBorder
    
    -- åˆ›å»ºæ•°æ®æ ‡ç­¾ï¼ˆç½‘æ ¼å¸ƒå±€ï¼‰
    local dataLabels = {}
    
    local statsToShow = {
        {name = "åŠ›é‡", id = "strength", color = Color3.fromRGB(255, 120, 120)},
        {name = "è€ä¹…", id = "durability", color = Color3.fromRGB(120, 200, 255)},
        {name = "è›‹ç™½è›‹", id = "protein", color = Color3.fromRGB(255, 220, 120)},
        {name = "å¢ç›ŠçŠ¶æ€", id = "boost", color = Color3.fromRGB(180, 255, 180)},
        {name = "é€Ÿåº¦", id = "speed", color = Color3.fromRGB(255, 180, 255)},
        {name = "åœ¨çº¿æ—¶é—´", id = "uptime", color = Color3.fromRGB(200, 200, 200)}
    }
    
    for i, stat in ipairs(statsToShow) do
        local row = math.floor((i - 1) / 2)
        local col = (i - 1) % 2
        
        local statFrame = Instance.new("Frame")
        statFrame.Size = UDim2.new(0.48, 0, 0, 28)
        statFrame.Position = UDim2.new(col * 0.5, 5, 0, 5 + (row * 32))
        statFrame.BackgroundColor3 = Color3.fromRGB(25, 15, 35)
        statFrame.BackgroundTransparency = 0.3
        statFrame.ZIndex = 12
        statFrame.Parent = contentFrame
        
        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(0.4, 0, 1, 0)
        label.Position = UDim2.new(0, 5, 0, 0)
        label.BackgroundTransparency = 1
        label.Text = stat.name .. ":"
        label.TextColor3 = Color3.fromRGB(220, 180, 255)
        label.TextSize = 12
        label.Font = Enum.Font.Gotham
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.ZIndex = 13
        label.Parent = statFrame
        
        local valueLabel = Instance.new("TextLabel")
        valueLabel.Name = stat.id
        valueLabel.Size = UDim2.new(0.55, 0, 1, 0)
        valueLabel.Position = UDim2.new(0.4, 0, 0, 0)
        valueLabel.BackgroundTransparency = 1
        valueLabel.Text = "åŠ è½½ä¸­..."
        valueLabel.TextColor3 = stat.color
        valueLabel.TextSize = 12
        valueLabel.Font = Enum.Font.GothamBold
        valueLabel.TextXAlignment = Enum.TextXAlignment.Right
        valueLabel.ZIndex = 13
        valueLabel.Parent = statFrame
        
        dataLabels[stat.id] = valueLabel
    end
    
    -- çŠ¶æ€æ 
    local statusBar = Instance.new("Frame")
    statusBar.Size = UDim2.new(1, -10, 0, 3)
    statusBar.Position = UDim2.new(0, 5, 1, -20)
    statusBar.BackgroundColor3 = Color3.fromRGB(40, 25, 55)
    statusBar.ZIndex = 12
    statusBar.Parent = contentFrame
    
    local statusFill = Instance.new("Frame")
    statusFill.Name = "StatusFill"
    statusFill.Size = UDim2.new(0, 0, 1, 0)
    statusFill.BackgroundColor3 = Color3.fromRGB(150, 90, 210)
    statusFill.ZIndex = 13
    statusFill.Parent = statusBar
    
    local statusText = Instance.new("TextLabel")
    statusText.Size = UDim2.new(1, 0, 0, 15)
    statusText.Position = UDim2.new(0, 0, 1, 2)
    statusText.BackgroundTransparency = 1
    statusText.Text = "ç›‘æ§è¿è¡Œä¸­..."
    statusText.TextColor3 = Color3.fromRGB(180, 160, 220)
    statusText.TextSize = 10
    statusText.Font = Enum.Font.Gotham
    statusText.TextXAlignment = Enum.TextXAlignment.Center
    statusText.ZIndex = 13
    statusText.Parent = statusBar
    
    -- å˜é‡å­˜å‚¨
    local monitorData = {
        window = mainWindow,
        minimized = false,
        startTime = tick(),
        lastStrength = 0,
        strengthSamples = {}
    }
    
    -- æ‹–åŠ¨åŠŸèƒ½
    local isDragging = false
    local dragStart, windowStart = Vector2.new(0, 0), Vector2.new(0, 0)
    
    titleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            isDragging = true
            dragStart = input.Position
            windowStart = Vector2.new(mainWindow.Position.X.Offset, mainWindow.Position.Y.Offset)
            mainWindow.ZIndex = 20
            border.ZIndex = 19
        end
    end)
    
    game:GetService("UserInputService").InputChanged:Connect(function(input)
        if isDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            mainWindow.Position = UDim2.new(0, windowStart.X + delta.X, 0, windowStart.Y + delta.Y)
        end
    end)
    
    game:GetService("UserInputService").InputEnded:Connect(function(input)
        if isDragging and input.UserInputType == Enum.UserInputType.MouseButton1 then
            isDragging = false
            mainWindow.ZIndex = 10
            border.ZIndex = 9
        end
    end)
    
    -- æœ€å°åŒ–åŠŸèƒ½
    minimizeButton.MouseButton1Click:Connect(function()
        monitorData.minimized = not monitorData.minimized
        
        if monitorData.minimized then
            mainWindow.Size = UDim2.new(0, 350, 0, 25)
            innerBorder.Visible = false
            minimizeButton.Text = "+"
            contentFrame.Visible = false
        else
            mainWindow.Size = UDim2.new(0, 350, 0, 200)
            innerBorder.Visible = true
            minimizeButton.Text = "â”€"
            contentFrame.Visible = true
        end
    end)
    
    -- æ ¼å¼åŒ–æ•°å­—å‡½æ•°
    local function formatNumber(value)
        if value < 1000 then return tostring(math.floor(value)) end
        local suffixes = {"K", "M", "B", "T", "Qa", "Qi"}
        local order = math.floor(math.log(value) / math.log(1000))
        local scaled = value / (1000 ^ order)
        return string.format("%.2f%s", scaled, suffixes[order] or "")
    end
    
    -- æ›´æ–°æ•°æ®å‡½æ•°
    local function updateData()
        while screenGui and screenGui.Parent do
            pcall(function()
                -- æ›´æ–°åŠ›é‡
                local strength = player.leaderstats.Strength.Value
                dataLabels.strength.Text = formatNumber(strength)
                
                -- è®¡ç®—åŠ›é‡å¢é•¿
                if monitorData.lastStrength > 0 then
                    local gain = strength - monitorData.lastStrength
                    table.insert(monitorData.strengthSamples, gain)
                    if #monitorData.strengthSamples > 10 then
                        table.remove(monitorData.strengthSamples, 1)
                    end
                end
                monitorData.lastStrength = strength
                
                -- æ›´æ–°è€ä¹…åº¦
                local durability = 0
                if player.Character then
                    local humanoid = player.Character:FindFirstChild("Humanoid")
                    if humanoid and humanoid:FindFirstChild("Durability") then
                        durability = humanoid.Durability.Value
                    end
                end
                dataLabels.durability.Text = formatNumber(durability)
                
                -- è›‹ç™½è›‹çŠ¶æ€
                local hasProtein = false
                if player.boostTimersFolder then
                    hasProtein = player.boostTimersFolder:FindFirstChild("Protein Egg") ~= nil
                end
                dataLabels.protein.Text = hasProtein and "âœ… æ¿€æ´»" or "âŒ æœªæ¿€æ´»"
                
                -- è®¡ç®—å¹³å‡é€Ÿåº¦
                local avgSpeed = 0
                if #monitorData.strengthSamples > 0 then
                    local total = 0
                    for _, gain in ipairs(monitorData.strengthSamples) do
                        total = total + gain
                    end
                    avgSpeed = total / #monitorData.strengthSamples
                end
                dataLabels.speed.Text = string.format("%.1f/s", avgSpeed)
                
                -- å¢ç›ŠçŠ¶æ€
                local hasBoost = false
                if player.Character then
                    for _, tool in pairs(player.Character:GetChildren()) do
                        if tool:IsA("Tool") and tool.Name:find("Boost") then
                            hasBoost = true
                            break
                        end
                    end
                end
                dataLabels.boost.Text = hasBoost and "âœ… æœ‰å¢ç›Š" or "âŒ æ— å¢ç›Š"
                
                -- åœ¨çº¿æ—¶é—´
                local uptime = tick() - monitorData.startTime
                local hours = math.floor(uptime / 3600)
                local minutes = math.floor((uptime % 3600) / 60)
                dataLabels.uptime.Text = string.format("%02d:%02d", hours, minutes)
                
                -- æ›´æ–°çŠ¶æ€æ¡ï¼ˆåŸºäºæ´»åŠ¨åº¦ï¼‰
                local activityLevel = math.min(avgSpeed * 10, 100)
                statusFill:TweenSize(UDim2.new(activityLevel / 100, 0, 1, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.5, true)
                
                -- çŠ¶æ€æ–‡æœ¬
                if avgSpeed > 10 then
                    statusText.Text = "âš¡ é«˜é€Ÿå¢é•¿ä¸­"
                    statusFill.BackgroundColor3 = Color3.fromRGB(100, 255, 100)
                elseif avgSpeed > 1 then
                    statusText.Text = "ğŸ“ˆ ç¨³å®šå¢é•¿"
                    statusFill.BackgroundColor3 = Color3.fromRGB(150, 90, 210)
                else
                    statusText.Text = "â¸ï¸ ç­‰å¾…è®­ç»ƒ"
                    statusFill.BackgroundColor3 = Color3.fromRGB(100, 100, 150)
                end
            end)
            
            wait(1) -- æ¯ç§’æ›´æ–°ä¸€æ¬¡
        end
    end
    
    -- å¯åŠ¨æ›´æ–°åç¨‹
    spawn(updateData)
    
    return {
        Destroy = function()
            if screenGui then
                screenGui:Destroy()
            end
        end,
        
        ToggleVisibility = function()
            mainWindow.Visible = not mainWindow.Visible
        end,
        
        SetPosition = function(x, y)
            mainWindow.Position = UDim2.new(0, x, 0, y)
        end,
        
        Minimize = function()
            monitorData.minimized = true
            mainWindow.Size = UDim2.new(0, 350, 0, 25)
            innerBorder.Visible = false
            minimizeButton.Text = "+"
            contentFrame.Visible = false
        end,
        
        Restore = function()
            monitorData.minimized = false
            mainWindow.Size = UDim2.new(0, 350, 0, 200)
            innerBorder.Visible = true
            minimizeButton.Text = "â”€"
            contentFrame.Visible = true
        end
    }
end

-- ==================== åœ¨è„šæœ¬ä¸­æ·»åŠ æ•°æ®ç›‘æ§ ====================
-- åœ¨ä½ çš„è„šæœ¬æœ€åæ·»åŠ ä»¥ä¸‹ä»£ç æ¥åˆ›å»ºæ•°æ®ç›‘æ§ï¼š

-- ç­‰å¾…WindUIåŠ è½½å®Œæˆ
task.wait(1)

-- åˆ›å»ºæ•°æ®ç›‘æ§
local dataMonitor = createWindUIDataMonitor()

-- å¯ä»¥æ·»åŠ åˆ°Combatçª—å£çš„æ§åˆ¶ï¼ˆå¯é€‰ï¼‰
WindUI.AddFunction("Combat", "æ•°æ®ç›‘æ§", function(state)
    if state then
        -- å¦‚æœä¹‹å‰å…³é—­äº†ï¼Œé‡æ–°åˆ›å»º
        if not dataMonitor then
            dataMonitor = createWindUIDataMonitor()
        else
            -- æ˜¾ç¤ºçª—å£
            dataMonitor.Restore()
        end
    else
        -- æœ€å°åŒ–çª—å£è€Œä¸æ˜¯é”€æ¯
        if dataMonitor then
            dataMonitor.Minimize()
        end
    end
end)

print("WindUIæ•°æ®ç›‘æ§å·²åŠ è½½")
