-- ==================== é˜²å¤šå¼€æ£€æŸ¥ ====================
local function AntiMultiOpen()
    local existingGui = game:GetService("CoreGui"):FindFirstChild("KJY_Team_AntiDup")
    if existingGui then
        game:GetService("Players").LocalPlayer:Kick("Script already running! Please wait.")
        return false
    end
    
    local antiDupGui = Instance.new("ScreenGui")
    antiDupGui.Name = "KJY_Team_AntiDup"
    antiDupGui.Parent = game:GetService("CoreGui")
    
    game:GetService("Players").PlayerRemoving:Connect(function(player)
        if player == game:GetService("Players").LocalPlayer then
            antiDupGui:Destroy()
        end
    end)
    
    return true
end

if not AntiMultiOpen() then
    return
end

-- ==================== åµŒå…¥å®Œæ•´çš„WindUIåº“ ====================
local WindUI = (function()
    local playerGui = game:GetService("Players").LocalPlayer:WaitForChild("PlayerGui")
    for _, gui in ipairs(playerGui:GetChildren()) do
        if gui:IsA("ScreenGui") and gui.Name == "WindUI" then
            gui:Destroy()
        end
    end

    -- åˆå§‹åŒ–
    local Players = game:GetService("Players")
    local UserInputService = game:GetService("UserInputService")
    local TweenService = game:GetService("TweenService")
    local RunService = game:GetService("RunService")

    local player = Players.LocalPlayer
    local username = player.Name
    local screenSize = workspace.CurrentCamera.ViewportSize

    -- åˆ†ç±»æ•°æ®
    local categories = {{name = "Combat", color = Color3.fromRGB(255, 80, 80), features = {}}}

    -- çª—å£å‚æ•°
    local windowWidth = math.min(160, screenSize.X * 0.35)
    local windowHeight = 200
    local startX, startY = 10, 50
    categories[1].position = Vector2.new(startX, startY)

    -- åˆ›å»ºGUI
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "WindUI"
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    screenGui.Parent = playerGui

    -- èƒŒæ™¯ï¼ˆæ›´é»‘ï¼‰
    local background = Instance.new("Frame")
    background.Size = UDim2.new(1, 0, 1, 0)
    background.BackgroundColor3 = Color3.fromRGB(5, 2, 8)
    background.BackgroundTransparency = 0.6
    background.ZIndex = -10
    background.Parent = screenGui

    local starGradient = Instance.new("UIGradient")
    starGradient.Rotation = 90
    starGradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(10, 5, 15)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(8, 3, 12)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(5, 1, 8))
    })
    starGradient.Parent = background

    -- æ¬¢è¿è¯­åœ¨ä¸­é—´
    local welcomeFrame = Instance.new("Frame")
    welcomeFrame.Size = UDim2.new(0, math.min(300, screenSize.X * 0.8), 0, 50)
    welcomeFrame.Position = UDim2.new(0.5, -math.min(300, screenSize.X * 0.8) / 2, 0.1, 0)
    welcomeFrame.BackgroundTransparency = 1
    welcomeFrame.ZIndex = 5
    welcomeFrame.Parent = screenGui

    local welcomeText = Instance.new("TextLabel")
    welcomeText.Size = UDim2.new(1, 0, 1, 0)
    welcomeText.BackgroundTransparency = 1
    welcomeText.Text = "Welcome " .. username
    welcomeText.TextColor3 = Color3.fromRGB(255, 255, 255)
    welcomeText.TextSize = 20
    welcomeText.Font = Enum.Font.GothamBold
    welcomeText.TextXAlignment = Enum.TextXAlignment.Center
    welcomeText.ZIndex = 5
    welcomeText.Parent = welcomeFrame

    -- ç²‰ç™½æ¸å˜æ•ˆæœ
    local textGradient = Instance.new("UIGradient")
    textGradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 240, 245)),
        ColorSequenceKeypoint.new(0.3, Color3.fromRGB(255, 220, 230)),
        ColorSequenceKeypoint.new(0.6, Color3.fromRGB(255, 200, 220)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 180, 210))
    })
    textGradient.Rotation = 90
    textGradient.Parent = welcomeText

    -- æ–‡å­—æè¾¹
    local textStroke = Instance.new("UIStroke")
    textStroke.Color = Color3.fromRGB(255, 150, 200)
    textStroke.Thickness = 2
    textStroke.Transparency = 0.3
    textStroke.Parent = welcomeText

    -- é—ªçƒåŠ¨ç”»ï¼ˆæ›´å¿«ï¼‰
    spawn(function()
        while welcomeText and welcomeText.Parent do
            local tweenIn = TweenService:Create(welcomeText, TweenInfo.new(0.3, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {
                TextTransparency = 0.1,
                TextStrokeTransparency = 0.5
            })
            tweenIn:Play()
            tweenIn.Completed:Wait()
            
            local tweenOut = TweenService:Create(welcomeText, TweenInfo.new(0.3, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {
                TextTransparency = 0.5,
                TextStrokeTransparency = 0.8
            })
            tweenOut:Play()
            tweenOut.Completed:Wait()
            
            local colors1 = {
                ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 250, 255)),
                ColorSequenceKeypoint.new(0.3, Color3.fromRGB(255, 230, 240)),
                ColorSequenceKeypoint.new(0.6, Color3.fromRGB(255, 210, 230)),
                ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 190, 220))
            }
            
            local colors2 = {
                ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 240, 245)),
                ColorSequenceKeypoint.new(0.3, Color3.fromRGB(255, 220, 230)),
                ColorSequenceKeypoint.new(0.6, Color3.fromRGB(255, 200, 220)),
                ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 180, 210))
            }
            
            textGradient.Color = ColorSequence.new(colors1)
            wait(0.2)
            textGradient.Color = ColorSequence.new(colors2)
            
            textStroke.Transparency = 0.2
            wait(0.1)
            textStroke.Transparency = 0.4
        end
    end)

    -- çª—å£åˆ›å»º
    local windows = {}
    local minimizedWindows = {}
    local functionStates = {}

    for i, category in ipairs(categories) do
        local window = Instance.new("Frame")
        window.Size = UDim2.new(0, windowWidth, 0, windowHeight)
        window.Position = UDim2.new(0, category.position.X, 0, category.position.Y)
        window.BackgroundColor3 = Color3.fromRGB(20, 12, 28)
        window.BackgroundTransparency = 0.1
        window.ZIndex = 1
        window.Parent = screenGui
        
        local border = Instance.new("Frame")
        border.Size = UDim2.new(1, 3, 1, 3)
        border.Position = UDim2.new(0, -1.5, 0, -1.5)
        border.BackgroundColor3 = Color3.fromRGB(100, 60, 150)
        border.ZIndex = 0
        border.Parent = window
        
        local innerBorder = Instance.new("Frame")
        innerBorder.Size = UDim2.new(1, -3, 1, -3)
        innerBorder.Position = UDim2.new(0, 1.5, 0, 1.5)
        innerBorder.BackgroundColor3 = Color3.fromRGB(18, 10, 25)
        innerBorder.BackgroundTransparency = 0.2
        innerBorder.Parent = border
        
        local titleBar = Instance.new("TextButton")
        titleBar.Size = UDim2.new(1, 0, 0, 25)
        titleBar.BackgroundColor3 = Color3.fromRGB(30, 18, 40)
        titleBar.Text = ""
        titleBar.AutoButtonColor = false
        titleBar.ZIndex = 2
        titleBar.Parent = innerBorder
        
        local titleLabel = Instance.new("TextLabel")
        titleLabel.Size = UDim2.new(1, -40, 1, 0)
        titleLabel.Position = UDim2.new(0, 8, 0, 0)
        titleLabel.BackgroundTransparency = 1
        titleLabel.Text = category.name
        titleLabel.TextColor3 = Color3.fromRGB(255, 180, 230)
        titleLabel.TextSize = 12
        titleLabel.Font = Enum.Font.GothamBold
        titleLabel.TextXAlignment = Enum.TextXAlignment.Left
        titleLabel.ZIndex = 2
        titleLabel.Parent = titleBar
        
        local minimizeButton = Instance.new("TextButton")
        minimizeButton.Size = UDim2.new(0, 20, 0, 20)
        minimizeButton.Position = UDim2.new(1, -22, 0.5, -10)
        minimizeButton.AnchorPoint = Vector2.new(0.5, 0.5)
        minimizeButton.BackgroundColor3 = Color3.fromRGB(45, 25, 65)
        minimizeButton.Text = "â”€"
        minimizeButton.TextColor3 = Color3.fromRGB(200, 150, 235)
        minimizeButton.TextSize = 16
        minimizeButton.Font = Enum.Font.GothamBold
        minimizeButton.AutoButtonColor = false
        minimizeButton.ZIndex = 2
        minimizeButton.Parent = titleBar
        
        local contentFrame = Instance.new("ScrollingFrame")
        contentFrame.Size = UDim2.new(1, -6, 1, -31)
        contentFrame.Position = UDim2.new(0, 3, 0, 28)
        contentFrame.BackgroundTransparency = 1
        contentFrame.ScrollBarThickness = 3
        contentFrame.ScrollBarImageColor3 = Color3.fromRGB(150, 90, 210)
        contentFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
        contentFrame.ZIndex = 2
        contentFrame.Parent = innerBorder
        
        local windowInfo = {
            frame = window,
            originalSize = UDim2.new(0, windowWidth, 0, windowHeight),
            originalPosition = UDim2.new(0, category.position.X, 0, category.position.Y),
            minimized = false,
            contentFrame = contentFrame,
            categoryName = category.name,
            featuresCount = 0
        }
        
        -- æ‹–åŠ¨åŠŸèƒ½
        local isDragging = false
        local dragStart, windowStart = Vector2.new(0, 0), Vector2.new(0, 0)
        
        titleBar.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                isDragging = true
                dragStart = input.Position
                windowStart = Vector2.new(window.Position.X.Offset, window.Position.Y.Offset)
                window.ZIndex = 10
                border.ZIndex = 9
            end
        end)
        
        UserInputService.InputChanged:Connect(function(input)
            if isDragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
                local delta = input.Position - dragStart
                window.Position = UDim2.new(0, windowStart.X + delta.X, 0, windowStart.Y + delta.Y)
            end
        end)
        
        UserInputService.InputEnded:Connect(function(input)
            if isDragging and (input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch) then
                isDragging = false
                window.ZIndex = 1
                border.ZIndex = 0
                
                local currentPos = window.Position
                local newX = math.max(5, math.min(currentPos.X.Offset, screenSize.X - windowWidth - 5))
                local newY = math.max(10, math.min(currentPos.Y.Offset, screenSize.Y - windowHeight - 10))
                
                window.Position = UDim2.new(0, newX, 0, newY)
                windowInfo.originalPosition = window.Position
            end
        end)
        
        -- æ”¶çº³åŠŸèƒ½
        minimizeButton.MouseButton1Click:Connect(function()
            windowInfo.minimized = not windowInfo.minimized
            
            if windowInfo.minimized then
                window.Size = UDim2.new(0, windowWidth, 0, 25)
                contentFrame.Visible = false
                minimizeButton.Text = "+"
                table.insert(minimizedWindows, windowInfo)
            else
                window.Size = windowInfo.originalSize
                contentFrame.Visible = true
                minimizeButton.Text = "â”€"
                for idx, win in ipairs(minimizedWindows) do
                    if win.frame == window then
                        table.remove(minimizedWindows, idx)
                        break
                    end
                end
            end
        end)
        
        table.insert(windows, windowInfo)
    end

    -- API
    local WindUI = {}

    function WindUI.AddFunction(categoryName, functionName, callback)
        for _, windowInfo in ipairs(windows) do
            if windowInfo.categoryName == categoryName then
                local contentFrame = windowInfo.contentFrame
                if contentFrame then
                    local functionButton = Instance.new("TextButton")
                    functionButton.Name = functionName
                    functionButton.Size = UDim2.new(1, -4, 0, 26)
                    functionButton.Position = UDim2.new(0, 2, 0, 5 + (windowInfo.featuresCount * 30))
                    functionButton.BackgroundColor3 = Color3.fromRGB(30, 18, 40)
                    functionButton.Text = functionName
                    functionButton.TextColor3 = Color3.fromRGB(200, 150, 235)
                    functionButton.TextSize = 12
                    functionButton.Font = Enum.Font.Gotham
                    functionButton.AutoButtonColor = true
                    functionButton.Parent = contentFrame
                    
                    functionStates[functionName] = false
                    
                    functionButton.MouseEnter:Connect(function()
                        if functionStates[functionName] then
                            functionButton.BackgroundColor3 = Color3.fromRGB(255, 150, 200)
                        else
                            functionButton.BackgroundColor3 = Color3.fromRGB(40, 22, 55)
                        end
                        functionButton.TextColor3 = Color3.fromRGB(240, 200, 255)
                    end)
                    
                    functionButton.MouseLeave:Connect(function()
                        if functionStates[functionName] then
                            functionButton.BackgroundColor3 = Color3.fromRGB(255, 130, 190)
                        else
                            functionButton.BackgroundColor3 = Color3.fromRGB(30, 18, 40)
                        end
                        functionButton.TextColor3 = Color3.fromRGB(200, 150, 235)
                    end)
                    
                    functionButton.MouseButton1Down:Connect(function()
                        if functionStates[functionName] then
                            functionButton.BackgroundColor3 = Color3.fromRGB(255, 100, 170)
                        else
                            functionButton.BackgroundColor3 = Color3.fromRGB(25, 14, 35)
                        end
                    end)
                    
                    functionButton.MouseButton1Up:Connect(function()
                        functionStates[functionName] = not functionStates[functionName]
                        
                        if functionStates[functionName] then
                            functionButton.BackgroundColor3 = Color3.fromRGB(255, 130, 190)
                            functionButton.TextColor3 = Color3.fromRGB(255, 240, 245)
                            print(functionName .. " å·²å¼€å¯")
                        else
                            functionButton.BackgroundColor3 = Color3.fromRGB(30, 18, 40)
                            functionButton.TextColor3 = Color3.fromRGB(200, 150, 235)
                            print(functionName .. " å·²å…³é—­")
                        end
                        
                        if callback then
                            callback(functionStates[functionName])
                        end
                    end)
                    
                    windowInfo.featuresCount = windowInfo.featuresCount + 1
                    local newHeight = math.max(200, 65 + (windowInfo.featuresCount * 30))
                    windowInfo.originalSize = UDim2.new(0, windowWidth, 0, newHeight)
                    window.Size = windowInfo.originalSize
                    contentFrame.CanvasSize = UDim2.new(0, 0, 0, 10 + (windowInfo.featuresCount * 30))
                    
                    print("å·²æ·»åŠ åŠŸèƒ½åˆ° " .. categoryName .. ": " .. functionName)
                    return true
                end
            end
        end
        return false
    end

    function WindUI.AddFunctions(categoryName, functionsTable)
        local successCount = 0
        for functionName, callback in pairs(functionsTable) do
            if WindUI.AddFunction(categoryName, functionName, callback) then
                successCount = successCount + 1
            end
        end
        return successCount > 0
    end

    function WindUI.GetWindow(categoryName)
        for _, windowInfo in ipairs(windows) do
            if windowInfo.categoryName == categoryName then
                return windowInfo
            end
        end
        return nil
    end

    function WindUI.GetAllWindows() return windows end

    function WindUI.RemoveWelcomeText()
        if welcomeFrame and welcomeFrame.Parent then
            welcomeFrame:Destroy()
        end
    end

    function WindUI.ShowWelcomeText()
        if welcomeFrame then
            welcomeFrame.Visible = true
        end
    end

    function WindUI.SetWelcomeText(newText)
        if welcomeText then
            welcomeText.Text = newText
        end
    end

    function WindUI.GetFunctionState(functionName)
        return functionStates[functionName] or false
    end

    function WindUI.SetFunctionState(functionName, state)
        if functionStates[functionName] ~= nil then
            functionStates[functionName] = state
            
            for _, windowInfo in ipairs(windows) do
                local button = windowInfo.contentFrame:FindFirstChild(functionName)
                if button then
                    if state then
                        button.BackgroundColor3 = Color3.fromRGB(255, 130, 190)
                        button.TextColor3 = Color3.fromRGB(255, 240, 245)
                    else
                        button.BackgroundColor3 = Color3.fromRGB(30, 18, 40)
                        button.TextColor3 = Color3.fromRGB(200, 150, 235)
                    end
                    
                    return true
                end
            end
        end
        return false
    end

    print("WindUI å·²åŠ è½½")
    print("ä¸­å¤®: å¿«é€Ÿé—ªçƒçš„ç²‰ç™½æ¸å˜æ¬¢è¿æ–‡å­—")
    print("å·¦ä¾§: å¯æ‹–åŠ¨ã€å¯æ”¶çº³çš„Combatçª—å£")
    print("ä½¿ç”¨ WindUI.AddFunction('Combat', 'åŠŸèƒ½å', å›è°ƒå‡½æ•°) æ¥æ·»åŠ åŠŸèƒ½")

    return WindUI
end)()

-- ==================== é˜²æŒ‚æœº ====================
local player = game:GetService("Players").LocalPlayer
player.Idled:Connect(function()
    game:GetService("VirtualUser"):Button2Down(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
    wait(1)
    game:GetService("VirtualUser"):Button2Up(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
end)

-- ==================== ç™½åå•éªŒè¯ ====================
local function checkWhitelist()
    local playerName = player.Name
    local success, isWhitelisted = pcall(function()
        local list = game:HttpGet("https://raw.githubusercontent.com/qiaoxxyxx/Roblox/refs/heads/main/whitelist.txt")
        local whitelist = {}
        for name in list:gmatch("[^,]+") do whitelist[name:gsub("%s+","")] = true end
        return whitelist[playerName]
    end)
    
    if not success or not isWhitelisted then
        player:Kick("æœªæˆæƒç”¨æˆ·")
        return false
    end
    return true
end

if not checkWhitelist() then return end

-- ==================== ç»Ÿè®¡æ¨¡å— ====================
local StatsModule = {
    samples = {},
    maxSamples = 6,
    sampleInterval = 20,
    lastStrength = 0,
    lastSampleTime = 0,
    lastBatchTime = 0,
    statsDisplay = nil,
    isActive = false
}

-- æ•°å€¼æ ¼å¼åŒ–å‡½æ•°
function StatsModule.formatNumber(value, decimals)
    if value == 0 then return "0" end
    local units = {"", "K", "M", "B", "T", "Qa", "Qi"}
    local order = math.floor(math.log(math.max(1, math.abs(value)), 1000))
    local unit = units[order + 1] or ("e" .. order)
    local scaledValue = math.floor(value * ((10 ^ decimals) / (1000 ^ order))) / (10 ^ decimals)
    return string.format("%." .. decimals .. "f%s", scaledValue, unit)
end

-- è·å–å½“å‰è€ä¹…åº¦
function StatsModule.getDurability()
    local success, durability = pcall(function()
        if player.Character then
            -- å°è¯•humanoidçš„è€ä¹…åº¦
            local humanoid = player.Character:FindFirstChild("Humanoid")
            if humanoid and humanoid:FindFirstChild("Durability") then
                return humanoid.Durability.Value
            end
            
            -- å°è¯•æ‰¾å…¶ä»–è€ä¹…åº¦å±æ€§
            for _, obj in pairs(player.Character:GetDescendants()) do
                if obj.Name == "Durability" and obj:IsA("NumberValue") then
                    return obj.Value
                end
            end
        end
        
        -- å°è¯•èƒŒåŒ…ä¸­çš„å·¥å…·è€ä¹…åº¦
        for _, tool in pairs(player.Backpack:GetChildren()) do
            if tool:FindFirstChild("Durability") then
                return tool.Durability.Value
            end
        end
        
        return 0
    end)
    
    return success and durability or 0
end

-- è·å–å½“å‰åŠ›é‡
function StatsModule.getStrength()
    local success, strength = pcall(function()
        return player.leaderstats.Strength.Value
    end)
    return success and strength or 0
end

-- æ£€æŸ¥è›‹ç™½è›‹å¢ç›Š
function StatsModule.checkProteinBoost()
    local success, boostExists = pcall(function()
        return player.boostTimersFolder:FindFirstChild("Protein Egg")
    end)
    return success and boostExists
end

-- è®¡ç®—å¹³å‡å¢ç›Š
function StatsModule.calculateAverageGain()
    if #StatsModule.samples == 0 then return 0 end
    local total = 0
    for _, value in ipairs(StatsModule.samples) do
        total = total + value
    end
    return total / #StatsModule.samples
end

-- åˆ›å»ºç»Ÿè®¡æ˜¾ç¤ºUI
function StatsModule:createDisplay()
    -- åˆ›å»ºç»Ÿè®¡æ¡†æ¶
    local statsFrame = Instance.new("Frame")
    statsFrame.Name = "StatsDisplay"
    statsFrame.Size = UDim2.new(0, 320, 0, 220)
    statsFrame.Position = UDim2.new(1, -330, 0.3, 0)
    statsFrame.BackgroundColor3 = Color3.fromRGB(20, 12, 28)
    statsFrame.BackgroundTransparency = 0.2
    statsFrame.BorderSizePixel = 0
    statsFrame.ZIndex = 5
    statsFrame.Parent = game:GetService("Players").LocalPlayer.PlayerGui:FindFirstChild("WindUI") or game.CoreGui
    
    local uiCorner = Instance.new("UICorner")
    uiCorner.CornerRadius = UDim.new(0, 8)
    uiCorner.Parent = statsFrame
    
    local uiStroke = Instance.new("UIStroke")
    uiStroke.Color = Color3.fromRGB(100, 60, 150)
    uiStroke.Thickness = 2
    uiStroke.Parent = statsFrame
    
    -- æ ‡é¢˜
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, 0, 0, 30)
    titleLabel.Position = UDim2.new(0, 0, 0, 0)
    titleLabel.BackgroundColor3 = Color3.fromRGB(40, 25, 55)
    titleLabel.BackgroundTransparency = 0.3
    titleLabel.Text = "ğŸ“Š å®æ—¶ç»Ÿè®¡"
    titleLabel.TextColor3 = Color3.fromRGB(255, 200, 255)
    titleLabel.TextSize = 16
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.Parent = statsFrame
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 8)
    titleCorner.Parent = titleLabel
    
    -- æ»šåŠ¨æ¡†æ¶ç”¨äºæ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
    local scrollFrame = Instance.new("ScrollingFrame")
    scrollFrame.Size = UDim2.new(1, -10, 1, -40)
    scrollFrame.Position = UDim2.new(0, 5, 0, 35)
    scrollFrame.BackgroundTransparency = 1
    scrollFrame.ScrollBarThickness = 3
    scrollFrame.ScrollBarImageColor3 = Color3.fromRGB(150, 90, 210)
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 200)
    scrollFrame.Parent = statsFrame
    
    -- ç»Ÿè®¡æ ‡ç­¾
    StatsModule.statsLabels = {}
    
    local statsData = {
        {id = "strength", label = "å½“å‰åŠ›é‡: ", color = Color3.fromRGB(180, 220, 255)},
        {id = "durability", label = "å½“å‰è€ä¹…: ", color = Color3.fromRGB(150, 255, 150)},
        {id = "avgGain", label = "å¹³å‡å¢ç›Š: ", color = Color3.fromRGB(180, 255, 180)},
        {id = "daily", label = "æ¯æ—¥é€Ÿåº¦: ", color = Color3.fromRGB(255, 220, 120)},
        {id = "monthly", label = "æ¯æœˆé€Ÿåº¦: ", color = Color3.fromRGB(255, 180, 220)},
        {id = "samples", label = "æ ·æœ¬æ•°é‡: ", color = Color3.fromRGB(200, 200, 200)},
        {id = "boost", label = "è›‹ç™½è›‹çŠ¶æ€: ", color = Color3.fromRGB(255, 150, 150)}
    }
    
    for i, stat in ipairs(statsData) do
        local statFrame = Instance.new("Frame")
        statFrame.Size = UDim2.new(1, 0, 0, 25)
        statFrame.Position = UDim2.new(0, 0, 0, (i-1) * 28)
        statFrame.BackgroundTransparency = 1
        statFrame.Parent = scrollFrame
        
        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(0.5, 0, 1, 0)
        label.Position = UDim2.new(0, 0, 0, 0)
        label.BackgroundTransparency = 1
        label.Text = stat.label
        label.TextColor3 = Color3.fromRGB(220, 180, 255)
        label.TextSize = 13
        label.Font = Enum.Font.Gotham
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.Parent = statFrame
        
        local valueLabel = Instance.new("TextLabel")
        valueLabel.Size = UDim2.new(0.5, 0, 1, 0)
        valueLabel.Position = UDim2.new(0.5, 0, 0, 0)
        valueLabel.BackgroundTransparency = 1
        valueLabel.Text = "è®¡ç®—ä¸­..."
        valueLabel.TextColor3 = stat.color
        valueLabel.TextSize = 13
        valueLabel.Font = Enum.Font.GothamBold
        valueLabel.TextXAlignment = Enum.TextXAlignment.Right
        valueLabel.Parent = statFrame
        
        StatsModule.statsLabels[stat.id] = valueLabel
    end
    
    self.statsDisplay = statsFrame
    self.isActive = true
    
    -- å¯åŠ¨æ›´æ–°åç¨‹
    spawn(function()
        while self.isActive and self.statsDisplay and self.statsDisplay.Parent do
            task.wait(1)  -- æ¯ç§’æ›´æ–°ä¸€æ¬¡
            
            pcall(function()
                -- è·å–å½“å‰å€¼
                local currentStrength = self.getStrength()
                local currentDurability = self.getDurability()
                local currentTime = tick()
                
                -- æ›´æ–°åŠ›é‡æ˜¾ç¤º
                self.statsLabels.strength.Text = self.formatNumber(currentStrength, 1)
                
                -- æ›´æ–°è€ä¹…åº¦æ˜¾ç¤º
                self.statsLabels.durability.Text = self.formatNumber(currentDurability, 1)
                
                -- è®¡ç®—åŠ›é‡å¢ç›Š
                if self.lastStrength > 0 then
                    local gainPerSecond = (currentStrength - self.lastStrength) / (currentTime - self.lastSampleTime)
                    
                    -- å¦‚æœè¾¾åˆ°é‡‡æ ·é—´éš”ï¼Œæ·»åŠ æ–°æ ·æœ¬
                    if currentTime - self.lastBatchTime >= self.sampleInterval then
                        table.insert(self.samples, gainPerSecond)
                        if #self.samples > self.maxSamples then
                            table.remove(self.samples, 1)
                        end
                        self.lastBatchTime = currentTime
                    end
                    
                    -- è®¡ç®—å¹³å‡å¢ç›Š
                    local avgGain = self.calculateAverageGain()
                    self.statsLabels.avgGain.Text = self.formatNumber(avgGain, 1) .. "/s"
                    
                    -- è®¡ç®—æ—¶é—´èŒƒå›´é€Ÿåº¦
                    local secondsInDay = 86400
                    local secondsInMonth = 2592000
                    
                    self.statsLabels.daily.Text = self.formatNumber(avgGain * secondsInDay, 1)
                    self.statsLabels.monthly.Text = self.formatNumber(avgGain * secondsInMonth, 1)
                    
                    -- æ›´æ–°æ ·æœ¬ä¿¡æ¯
                    self.statsLabels.samples.Text = #self.samples .. "/" .. self.maxSamples
                else
                    -- ç¬¬ä¸€æ¬¡è®°å½•
                    self.lastStrength = currentStrength
                    self.lastSampleTime = currentTime
                    self.lastBatchTime = currentTime
                end
                
                -- æ›´æ–°å¢ç›ŠçŠ¶æ€
                local hasBoost = self.checkProteinBoost()
                if hasBoost then
                    self.statsLabels.boost.Text = "âœ… Protein Egg x2"
                    self.statsLabels.boost.TextColor3 = Color3.fromRGB(100, 255, 100)
                else
                    self.statsLabels.boost.Text = "âŒ No Boost"
                    self.statsLabels.boost.TextColor3 = Color3.fromRGB(255, 100, 100)
                end
                
                -- æ›´æ–°æœ€åè®°å½•çš„å€¼
                self.lastStrength = currentStrength
                self.lastSampleTime = currentTime
            end)
        end
    end)
end

-- ç§»é™¤ç»Ÿè®¡æ˜¾ç¤º
function StatsModule:removeDisplay()
    self.isActive = false
    if self.statsDisplay and self.statsDisplay.Parent then
        self.statsDisplay:Destroy()
        self.statsDisplay = nil
    end
end

-- ==================== æ·»åŠ æ‰€æœ‰åŠŸèƒ½åˆ°Combatåˆ†ç±» ====================

-- 1. æé€Ÿé”»ç‚¼åŠŸèƒ½
local spamTraining = false
local batchSize = 20

local function spamExerciseEvents()
    while spamTraining do
        pcall(function()
            local muscleEvent = player.muscleEvent
            for i = 0, batchSize do
                muscleEvent:FireServer("rep")
            end
        end)
        task.wait(0.01)
    end
end

WindUI.AddFunction("Combat", "æé€Ÿé”»ç‚¼", function(state)
    spamTraining = state
    if state then
        task.spawn(spamExerciseEvents)
        print("æé€Ÿé”»ç‚¼å·²å¼€å¯")
    else
        print("æé€Ÿé”»ç‚¼å·²å…³é—­")
    end
end)

-- 2. è‡ªåŠ¨è›‹ç™½è›‹åŠŸèƒ½
local autoProtein = false

WindUI.AddFunction("Combat", "è‡ªåŠ¨è›‹ç™½è›‹", function(state)
    autoProtein = state
    if state then
        task.spawn(function()
            while autoProtein do
                pcall(function()
                    if not player.boostTimersFolder:FindFirstChild("Protein Egg") then
                        local egg = player.Backpack:FindFirstChild("Protein Egg")
                        if egg then
                            player.Character.Humanoid:EquipTool(egg)
                            wait(0.1)
                            if player.Character:FindFirstChild("Protein Egg") then
                                player.muscleEvent:FireServer("proteinEgg", player.Character:FindFirstChild("Protein Egg"))
                                player.Character.Humanoid:UnequipTools()
                            end
                        end
                    end
                end)
                wait(0.2)
            end
        end)
    end
end)

-- 3. æ¸…é™¤å¢ç›ŠUIåŠŸèƒ½
WindUI.AddFunction("Combat", "æ¸…é™¤å¢ç›ŠUI", function()
    local keywords = {"+","Coins","Coin","Strength","Exp","Experience","Level","Damage","Health"}
    local protected = {"WindUI","Crazy Top","Rayfield"}
    
    local function cleanGui(parent)
        for _, gui in ipairs(parent:GetChildren()) do
            if gui:IsA("ScreenGui") then
                local shouldRemove = true
                for _, name in ipairs(protected) do
                    if gui.Name:find(name) then
                        shouldRemove = false
                        break
                    end
                end
                
                if shouldRemove then
                    for _, element in ipairs(gui:GetDescendants()) do
                        if (element:IsA("TextLabel") or element:IsA("TextButton")) and element.Text then
                            for _, keyword in ipairs(keywords) do
                                if element.Text:find(keyword) then
                                    gui:Destroy()
                                    break
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    
    cleanGui(game:GetService("CoreGui"))
    cleanGui(player:FindFirstChild("PlayerGui"))
    print("å¢ç›ŠUIå·²æ¸…é™¤")
end)

-- 4. è‡ªåŠ¨çƒ­å¸¦å¥¶æ˜”åŠŸèƒ½
local autoShake = false

WindUI.AddFunction("Combat", "è‡ªåŠ¨çƒ­å¸¦å¥¶æ˜”", function(state)
    autoShake = state
    if state then
        task.spawn(function()
            while autoShake do
                pcall(function()
                    local shake = player.Backpack:FindFirstChild("Tropical Shake")
                    if shake then
                        player.Character.Humanoid:EquipTool(shake)
                        wait(0.05)
                        if player.Character:FindFirstChild("Tropical Shake") then
                            player.muscleEvent:FireServer("tropicalShake", player.Character:FindFirstChild("Tropical Shake"))
                            player.Character.Humanoid:UnequipTools()
                        end
                    end
                end)
                wait(0.1)
            end
        end)
    end
end)

-- 5. å®æ—¶ç»Ÿè®¡æ˜¾ç¤ºåŠŸèƒ½
WindUI.AddFunction("Combat", "å®æ—¶ç»Ÿè®¡æ˜¾ç¤º", function(state)
    if state then
        StatsModule:createDisplay()
        print("å®æ—¶ç»Ÿè®¡æ˜¾ç¤ºå·²å¼€å¯")
    else
        StatsModule:removeDisplay()
        print("å®æ—¶ç»Ÿè®¡æ˜¾ç¤ºå·²å…³é—­")
    end
end
